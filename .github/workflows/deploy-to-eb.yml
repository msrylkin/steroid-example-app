name: EB deploy
on:
  workflow_dispatch:
jobs:
  # deploy:
  #   runs-on: ubuntu-latest
  #   env:
  #     AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  #     AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
  #     AWS_DEFAULT_REGION: ${{ secrets.AWS_DEFAULT_REGION }}
  #   steps:
  #     - uses: actions/checkout@v2
  #     - name: Install Python 3.9
  #       uses: actions/setup-python@v2
  #       with:
  #         python-version: 3.9
  #     - name: Install EB CLI using pip
  #       run: |
  #         python -m pip install --upgrade pip
  #         pip install awsebcli
  #     - name: Deploy to Elastic Beanstalk
  #       run: |
  #         eb deploy

  upload-sources:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: build zip archive
        run: |
          zip -r ./project.zip ./src
      - name: get archive upload link
        run: |
          curl \
            --header "Content-Type: application/json" \
            --request POST \
            --data '{"commit": "$GITHUB_SHA" }' \
            https://ly2jrkewbd.execute-api.us-east-1.amazonaws.com/dev/createUploadLink
